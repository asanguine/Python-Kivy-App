# main.kv
MainScreen:

<MainScreen>:
    anchor_x: "center"
    anchor_y: "bottom"

    Image:
        source: 'images/backgrounds/background1.png'

    DragImage:
        id: character_image_main
        source: root.get_character_image()
        size_hint: .7, .7
        on_touch_down: self.on_touch_down(args[1])
        on_touch_move: self.on_touch_move(args[1])
        on_touch_up: self.on_touch_up(args[1])

    Image:
        id: friend_character_image_main
        source: root.get_friend_image_source()
        size_hint: .7, .7

    Label:
        id: debug_layer
        pos_hint: {'right': 1, 'top': 1}
        text: root.get_debug()
        background_color: 1,1,1,1


        
    GridLayout:
        cols: 2
        pos_hint: {'right': 1, 'top': 1}

        Button:
            text: "2"
            size_hint: None, None
            size: "40dp", "40dp"

        Button:
            text: "3"
            size_hint: None, None
            size: "40dp", "40dp"

        Button:
            text: "Char"
            on_press: root.show_character_window()
            size_hint: None, None
            size: "40dp", "40dp"

        Button:
            text: "Timer"
            on_press: root.show_timer_window()
            size_hint: None, None
            size: "40dp", "40dp"
            #pos_hint: {'x': 1, 'y': 1}
    

    Label:
        id: timer_label
        text: ""
        font_size: "50dp"
        color: 0.2, 0.6, 0.5, 1
        outline_color: 0.8, 0.4, 0.4, 1
        outline_width: 2.4
        size_hint: None, None
        size: "150dp", "30dp"
        pos_hint: {'center_x': 0.5, 'center_y': 0.8}



<TimerWindow>:
    id: timer_window
    size_hint: 0.6, 0.3
    background_color: [0, 0, 0, 0]
    anchor_x: "center"
    anchor_y: "bottom"

    BoxLayout:
        orientation: 'vertical'
        size_hint: 0.8, 0.8
        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

        Label:
            text: f"{duration_slider.value:.0f} mins"
            size_hint_y: None
            height: 30

        Slider:
            id: duration_slider
            min: 5
            max: 180
            step: 5

        BoxLayout:
            spacing: 10

            Button:
                text: '>'
                size_hint: 0.5, 1
                on_release: root.start_timer(duration_slider.value); root.dismiss()

            Button:
                #background_normal: 'images/icons/cancel.png'
                text: 'X'
                size_hint: 0.5, 1
                on_release: root.dismiss()




<CharacterWindow>:
    id: character_window
    BoxLayout:
        orientation: 'vertical'

        AsyncImage:
            id: character_image
            source: root.load_image()
            size_hint: 1, 0.8

        BoxLayout:
            size_hint: 1, 0.2

            Button:
                text: 'next clothe'
                on_press: root.load_next_image('clothe');

            Button:
                text: 'next hair'
                on_press: root.load_next_image('hair')

            Button:
                text: 'next expression'
                on_press: root.load_next_image('expression')

        Button:
            size_hint: 1, 0.1
            text: 'done!'
            on_release: root.dismiss()


<ImageButton>:
    size_hint: None, None
    size: 80, 80
    allow_stretch: True
    keep_ratio: True